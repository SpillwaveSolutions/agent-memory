# Milestone v1.0: MVP

**Status:** ✅ SHIPPED 2026-01-30
**Phases:** 1-8
**Total Plans:** 20

## Overview

This roadmap delivered a local, append-only conversational memory system with TOC-based agentic navigation. The journey proceeded from foundational storage through TOC construction, grips for provenance, query capabilities, hook integration, and culminated in CCH hook integration and a Claude Code plugin.

## Phases

### Phase 1: Foundation

**Goal**: Establish the storage layer, domain types, gRPC service structure, and daemon binary so events can be ingested and persisted
**Depends on**: Nothing (first phase)
**Plans**: 5 plans

Plans:
- [x] 01-00-PLAN.md — Workspace scaffolding (crate structure, proto placeholder, docs/README.md)
- [x] 01-01-PLAN.md — Storage layer (RocksDB setup, column families, compaction, time-prefixed keys)
- [x] 01-02-PLAN.md — Domain types (Event, TocNode, Grip, OutboxEntry, Settings configuration)
- [x] 01-03-PLAN.md — gRPC service scaffolding (tonic setup, protos, IngestEvent RPC, health, reflection)
- [x] 01-04-PLAN.md — CLI daemon binary (start/stop/status commands, config loading, graceful shutdown)

**Details:**
- Key format: `{prefix}:{timestamp_ms:013}:{ulid}` for time-range scans
- 6 column families: events, toc_nodes, toc_latest, grips, outbox, checkpoints
- Layered config: defaults → config file → env vars → CLI flags

### Phase 2: TOC Building

**Goal**: Construct the time-based Table of Contents hierarchy with summaries at each level
**Depends on**: Phase 1
**Plans**: 3 plans

Plans:
- [x] 02-01: Segmentation engine (time/token boundaries, overlap)
- [x] 02-02: Summarizer trait and implementation
- [x] 02-03: TOC hierarchy builder (nodes, rollups, checkpointing)

**Details:**
- tiktoken-rs for accurate token counting
- Time-gap boundary: 30 min, token threshold: 4000
- Overlap: 5 min or 500 tokens for context continuity
- TOC node IDs: `toc:{level}:{time_identifier}`

### Phase 3: Grips & Provenance

**Goal**: Anchor TOC summaries to source evidence through grips (excerpt + event pointers)
**Depends on**: Phase 2
**Plans**: 3 plans

Plans:
- [x] 03-01: Grip storage and data model
- [x] 03-02: Summarizer grip extraction integration
- [x] 03-03: Grip expansion (context retrieval)

**Details:**
- Grip ID format: `grip:{timestamp_ms}:{ulid}`
- Term-overlap scoring (>30% match threshold)
- Context window with events_before/after

### Phase 4: Query Layer

**Goal**: Expose navigation RPCs so agents can traverse the TOC and retrieve events
**Depends on**: Phase 3
**Plans**: 2 plans

Plans:
- [x] 04-01: TOC navigation RPCs (GetTocRoot, GetNode, BrowseToc)
- [x] 04-02: Event retrieval RPCs (GetEvents, ExpandGrip)

**Details:**
- Pagination via continuation_token
- Proto enums with EVENT_ROLE_ and EVENT_TYPE_ prefixes

### Phase 5: Integration

**Goal**: Connect hook handlers for event ingestion and provide CLI tools for querying and administration
**Depends on**: Phase 4
**Plans**: 3 plans

Plans:
- [x] 05-01: Hook handler integration (IngestEvent client, event mapping)
- [x] 05-02: Query CLI (manual navigation, testing)
- [x] 05-03: Admin commands (rebuild-toc, compact, status)

**Details:**
- memory-client crate provides client API
- HookEvent maps to Event with 1:1 type mapping
- Admin CLI opens storage directly for local operations

### Phase 6: End-to-End Demo

**Goal**: Validate the complete workflow from conversation capture through query resolution
**Depends on**: Phase 5
**Plans**: 2 plans

Plans:
- [x] 06-01: Integration test harness and demo script
- [x] 06-02: Documentation and usage examples

**Details:**
- ARCHITECTURE.md, USAGE.md, INTEGRATION.md created
- Demo script validates full workflow

### Phase 7: Agentic Memory Plugin

**Goal**: Provide a Claude Code marketplace plugin for querying past conversations with commands and autonomous agents
**Depends on**: Phase 6
**Plans**: 1 plan

Plans:
- [x] 07-01: Agentic memory query plugin (marketplace.json, 3 commands, 1 agent, graded skill)

**Details:**
- Plugin scored 99/100 on skill grading rubric
- Commands: /memory-search, /memory-recent, /memory-context
- Agent: memory-navigator for complex multi-step queries

### Phase 8: CCH Hook Integration

**Goal**: Integrate agent-memory with code_agent_context_hooks (CCH) for automatic event capture
**Depends on**: Phase 7
**Plans**: 1 plan

Plans:
- [x] 08-01: CCH hook handler (memory-ingest binary, event mapping, hooks.yaml configuration)

**Details:**
- memory-ingest binary reads CCH JSON from stdin
- Fail-open behavior: always return `{"continue":true}`
- Reuses memory-client types (HookEvent, map_hook_event)

---

## Milestone Summary

**Key Decisions:**

| Decision | Rationale | Outcome |
|----------|-----------|---------|
| TOC as primary navigation | Agentic search beats brute-force; indexes are disposable | ✓ Validated |
| Append-only storage | Immutable truth, no deletion complexity | ✓ Validated |
| Hooks for ingestion | Zero token overhead, works across agents | ✓ Validated |
| Per-project stores first | Simpler mental model | ✓ Validated |
| gRPC only (no HTTP) | Clean contract, no framework churn | ✓ Validated |
| Pluggable summarizer | Start with API, swap to local later | ✓ Validated |
| Fail-open CCH integration | Never block Claude if memory is down | ✓ Validated |

**Issues Resolved:**

- Storage layer crash recovery via checkpoints
- TOC versioning for concurrent updates
- Grip extraction with term-overlap scoring
- Query pagination for large result sets

**Technical Debt Incurred:**

- RebuildToc admin command is placeholder (deferred)
- No automated E2E tests in CI (manual demo script)
- Teleport indexes deferred to v2

---

*Archived: 2026-01-30 as part of v1.0.0 milestone completion*
*For current project status, see .planning/ROADMAP.md*
