---
phase: 22-copilot-cli-adapter
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - plugins/memory-copilot-adapter/.github/skills/memory-query/SKILL.md
  - plugins/memory-copilot-adapter/.github/skills/memory-query/references/command-reference.md
  - plugins/memory-copilot-adapter/.github/skills/retrieval-policy/SKILL.md
  - plugins/memory-copilot-adapter/.github/skills/retrieval-policy/references/command-reference.md
  - plugins/memory-copilot-adapter/.github/skills/topic-graph/SKILL.md
  - plugins/memory-copilot-adapter/.github/skills/topic-graph/references/command-reference.md
  - plugins/memory-copilot-adapter/.github/skills/bm25-search/SKILL.md
  - plugins/memory-copilot-adapter/.github/skills/bm25-search/references/command-reference.md
  - plugins/memory-copilot-adapter/.github/skills/vector-search/SKILL.md
  - plugins/memory-copilot-adapter/.github/skills/vector-search/references/command-reference.md
  - plugins/memory-copilot-adapter/.github/agents/memory-navigator.agent.md
  - plugins/memory-copilot-adapter/plugin.json
autonomous: true

must_haves:
  truths:
    - "Skills provide tier-aware retrieval with fallback chains identical to Claude Code and OpenCode"
    - "Skills use SKILL.md format with YAML frontmatter (same as Claude Code -- Copilot uses identical format)"
    - "Skills are stored in .github/skills/ (Copilot canonical path, not .claude/skills/)"
    - "Skills are separate copies (not symlinks) for portability"
    - "Navigator agent is a proper .agent.md file (unlike Gemini which required embedding in skill)"
    - "Navigator agent has description, tools, and infer:true in frontmatter"
    - "plugin.json manifest enables /plugin install from local path or GitHub repo URL"
    - "No TOML commands created (Copilot uses skills, not TOML commands)"
  artifacts:
    - path: "plugins/memory-copilot-adapter/.github/skills/memory-query/SKILL.md"
      provides: "Core query skill with tier-aware retrieval and command instructions"
      min_lines: 100
    - path: "plugins/memory-copilot-adapter/.github/skills/retrieval-policy/SKILL.md"
      provides: "Tier detection and intent classification skill"
      min_lines: 30
    - path: "plugins/memory-copilot-adapter/.github/skills/bm25-search/SKILL.md"
      provides: "BM25 keyword search skill"
      min_lines: 20
    - path: "plugins/memory-copilot-adapter/.github/skills/vector-search/SKILL.md"
      provides: "Vector semantic search skill"
      min_lines: 20
    - path: "plugins/memory-copilot-adapter/.github/skills/topic-graph/SKILL.md"
      provides: "Topic graph exploration skill"
      min_lines: 20
    - path: "plugins/memory-copilot-adapter/.github/agents/memory-navigator.agent.md"
      provides: "Navigator agent with autonomous retrieval and intent routing"
      min_lines: 50
    - path: "plugins/memory-copilot-adapter/plugin.json"
      provides: "Plugin manifest for /plugin install"
      contains: "memory-copilot-adapter"
  key_links:
    - from: "plugins/memory-copilot-adapter/.github/skills/memory-query/SKILL.md"
      to: "memory-daemon query"
      via: "CLI commands in skill instructions"
      pattern: "memory-daemon.*query"
    - from: "plugins/memory-copilot-adapter/.github/agents/memory-navigator.agent.md"
      to: "plugins/memory-copilot-adapter/.github/skills/memory-query/SKILL.md"
      via: "agent references skills for retrieval workflow"
      pattern: "memory-query"
    - from: "plugins/memory-copilot-adapter/plugin.json"
      to: "plugins/memory-copilot-adapter/.github/"
      via: "plugin auto-discovery of agents, skills, hooks"
      pattern: "memory-copilot-adapter"
---

<objective>
Create skills, navigator agent, and plugin manifest for the Copilot CLI adapter. Skills use the standard SKILL.md format (identical to Claude Code). The navigator agent uses Copilot's native `.agent.md` format (a proper agent file, unlike Gemini where navigator logic had to be embedded in a skill). The plugin.json manifest enables installation via `/plugin install`.

Purpose: Enable Copilot CLI users to query past conversations with the same capabilities as Claude Code, OpenCode, and Gemini users -- tier-aware retrieval, intent classification, and fallback chains -- plus a proper navigator agent for complex queries.

Output: 5 skill directories with SKILL.md and references, 1 navigator agent file, 1 plugin manifest.
</objective>

<execution_context>
@/Users/richardhightower/.claude/get-shit-done/workflows/execute-plan.md
@/Users/richardhightower/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-copilot-cli-adapter/22-RESEARCH.md
@plugins/memory-opencode-plugin/.opencode/skill/memory-query/SKILL.md
@plugins/memory-opencode-plugin/.opencode/skill/retrieval-policy/SKILL.md
@plugins/memory-opencode-plugin/.opencode/skill/topic-graph/SKILL.md
@plugins/memory-opencode-plugin/.opencode/skill/bm25-search/SKILL.md
@plugins/memory-opencode-plugin/.opencode/skill/vector-search/SKILL.md
@plugins/memory-opencode-plugin/.opencode/skill/memory-query/references/command-reference.md
@plugins/memory-opencode-plugin/.opencode/skill/retrieval-policy/references/command-reference.md
@plugins/memory-opencode-plugin/.opencode/skill/topic-graph/references/command-reference.md
@plugins/memory-opencode-plugin/.opencode/skill/bm25-search/references/command-reference.md
@plugins/memory-opencode-plugin/.opencode/skill/vector-search/references/command-reference.md
@plugins/memory-opencode-plugin/.opencode/agents/memory-navigator.md
@plugins/memory-gemini-adapter/.gemini/skills/memory-query/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create skills with SKILL.md format for Copilot</name>
  <files>
    plugins/memory-copilot-adapter/.github/skills/memory-query/SKILL.md
    plugins/memory-copilot-adapter/.github/skills/memory-query/references/command-reference.md
    plugins/memory-copilot-adapter/.github/skills/retrieval-policy/SKILL.md
    plugins/memory-copilot-adapter/.github/skills/retrieval-policy/references/command-reference.md
    plugins/memory-copilot-adapter/.github/skills/topic-graph/SKILL.md
    plugins/memory-copilot-adapter/.github/skills/topic-graph/references/command-reference.md
    plugins/memory-copilot-adapter/.github/skills/bm25-search/SKILL.md
    plugins/memory-copilot-adapter/.github/skills/bm25-search/references/command-reference.md
    plugins/memory-copilot-adapter/.github/skills/vector-search/SKILL.md
    plugins/memory-copilot-adapter/.github/skills/vector-search/references/command-reference.md
  </files>
  <action>
Create skill directories and files for the Copilot adapter. Copilot CLI uses the IDENTICAL SKILL.md format as Claude Code (confirmed by research -- same Markdown + YAML frontmatter). Skills go in `.github/skills/` (the Copilot canonical path, NOT `.claude/skills/`).

**CRITICAL: Copilot has NO TOML commands.** Unlike Gemini (which needed TOML commands + skills), Copilot uses skills that auto-activate based on their description matching the user's prompt. The memory-query skill must include explicit instructions for how to execute /memory-search, /memory-recent, and /memory-context equivalent functionality -- since there are no separate command files to provide this.

**For retrieval-policy, topic-graph, bm25-search, vector-search:**
Copy the SKILL.md and references/command-reference.md files from `plugins/memory-opencode-plugin/.opencode/skill/` to `plugins/memory-copilot-adapter/.github/skills/`. These skills are format-compatible and need no modifications beyond ensuring YAML frontmatter is valid. Copilot accepts extra frontmatter fields with warnings (v0.0.403+), so keep all existing fields.

**For memory-query (ENHANCED with command equivalents):**
Copy the base SKILL.md from the OpenCode plugin, then add:
1. A "Quick Commands" section that provides the equivalent of /memory-search, /memory-recent, and /memory-context as skill-embedded instructions:
   - "Search memories": `memory-daemon retrieval route "<query>"` with optional `--agent copilot`
   - "Recent memories": `memory-daemon query root` then navigate to current period
   - "Expand context": `memory-daemon query expand --grip-id "<grip_id>" --before 5 --after 5`
2. Argument parsing instructions for each command equivalent (topic, --period, --days, --limit, --agent, grip ID)
3. Output formatting templates in markdown
4. Error handling guidance (daemon not running, no results)
5. Footer suggesting drill-down with grip expansion

Do NOT embed navigator logic in the memory-query skill (unlike Gemini). Copilot has proper `.agent.md` support, so the navigator will be a separate agent file (Task 2).

All skills must have YAML frontmatter with `name`, `description`, `license`, and `metadata` fields matching the existing pattern from other adapters.
  </action>
  <verify>
1. All 5 skill directories exist with SKILL.md files:
   - `test -f plugins/memory-copilot-adapter/.github/skills/memory-query/SKILL.md`
   - `test -f plugins/memory-copilot-adapter/.github/skills/retrieval-policy/SKILL.md`
   - `test -f plugins/memory-copilot-adapter/.github/skills/topic-graph/SKILL.md`
   - `test -f plugins/memory-copilot-adapter/.github/skills/bm25-search/SKILL.md`
   - `test -f plugins/memory-copilot-adapter/.github/skills/vector-search/SKILL.md`
2. All 5 reference directories exist with command-reference.md:
   - `test -f plugins/memory-copilot-adapter/.github/skills/memory-query/references/command-reference.md` (repeat for each)
3. memory-query/SKILL.md contains "Search" or "search" (command equivalent)
4. memory-query/SKILL.md contains "retrieval route" (search command)
5. memory-query/SKILL.md contains "expand" (context command)
6. All SKILL.md files have YAML frontmatter: `head -1 plugins/memory-copilot-adapter/.github/skills/*/SKILL.md` shows `---`
7. Each SKILL.md has `name:` in frontmatter
8. No TOML files exist: `ls plugins/memory-copilot-adapter/**/*.toml 2>/dev/null` returns nothing
  </verify>
  <done>
Five skill directories exist with SKILL.md + references/command-reference.md files. Four skills (retrieval-policy, topic-graph, bm25-search, vector-search) are direct copies from OpenCode plugin. memory-query skill includes command-equivalent instructions for search, recent, and context operations with argument parsing, output formatting, and error handling. No TOML command files exist (Copilot uses skills, not TOML commands).
  </done>
</task>

<task type="auto">
  <name>Task 2: Create navigator agent and plugin manifest</name>
  <files>
    plugins/memory-copilot-adapter/.github/agents/memory-navigator.agent.md
    plugins/memory-copilot-adapter/plugin.json
  </files>
  <action>
Create the navigator agent as a proper `.agent.md` file (Copilot's native agent format) and the plugin.json manifest for `/plugin install` support.

**memory-navigator.agent.md:**
Copilot agents use Markdown + YAML frontmatter at `.github/agents/` (project) or `~/.copilot/agents/` (personal). The frontmatter fields:
- `name`: `memory-navigator` (optional but recommended)
- `description`: Required. Describe the agent's purpose: "Autonomous agent for intelligent memory retrieval with tier-aware routing, intent classification, and automatic fallback chains. Invoke when asked about past conversations, previous sessions, or historical code discussions."
- `tools`: `["execute", "read", "search"]` (Copilot tool names for bash execution, file reading, code search)
- `infer`: `true` (allows Copilot to auto-select this agent when query matches its description)

The agent body should contain the FULL navigator intelligence from the OpenCode `memory-navigator.md`, adapted for Copilot:
1. When to Use section with trigger patterns
2. Skills Used section listing all 5 skills
3. Tier-aware routing strategy table (Tiers 1-5)
4. Intent-based execution (Explore, Answer, Locate, Time-boxed)
5. Process section (check tier -> classify intent -> execute through layers -> expand grips -> return with explainability)
6. Output format template
7. Example queries by intent
8. Limitations

Key adaptation: Copilot's `infer: true` means the agent can be auto-invoked (unlike OpenCode where you need explicit `@memory-navigator`). The agent can also be invoked explicitly via `/agent memory-navigator`. Reference Copilot tool names (`execute` for running bash commands, `read` for file access, `search` for code search) instead of OpenCode tool names.

**plugin.json:**
Create the plugin manifest at the adapter root:
```json
{
  "name": "memory-copilot-adapter",
  "version": "2.1.0",
  "description": "Agent memory adapter for GitHub Copilot CLI - enables intelligent memory retrieval and automatic event capture",
  "author": "SpillwaveSolutions",
  "repository": "https://github.com/SpillwaveSolutions/agent-memory"
}
```
This enables `copilot /plugin install /path/to/memory-copilot-adapter` or `/plugin install https://github.com/SpillwaveSolutions/agent-memory/tree/main/plugins/memory-copilot-adapter`.
  </action>
  <verify>
1. `test -f plugins/memory-copilot-adapter/.github/agents/memory-navigator.agent.md`
2. `head -5 plugins/memory-copilot-adapter/.github/agents/memory-navigator.agent.md` shows YAML frontmatter with `---`
3. Agent file contains "description:" in frontmatter
4. Agent file contains "infer: true" or "infer:true"
5. Agent file contains "Tier" or "tier" (tier-aware routing)
6. Agent file contains "intent" or "Intent" (intent classification)
7. Agent file contains "memory-daemon" (CLI command references)
8. Agent file contains "fallback" or "Fallback" (fallback chain logic)
9. `test -f plugins/memory-copilot-adapter/plugin.json`
10. `cat plugins/memory-copilot-adapter/plugin.json | python3 -c "import sys,json; d=json.load(sys.stdin); print(d['name'])"` outputs `memory-copilot-adapter`
11. `cat plugins/memory-copilot-adapter/plugin.json | python3 -c "import sys,json; d=json.load(sys.stdin); print(d['version'])"` outputs `2.1.0`
  </verify>
  <done>
Navigator agent exists as a proper .agent.md file with full tier-aware routing, intent classification, fallback chains, and explainability. Agent has infer:true for auto-invocation and tools list for Copilot. plugin.json manifest exists with correct name, version, description, and repository URL enabling /plugin install.
  </done>
</task>

</tasks>

<verification>
- All 5 skills have SKILL.md with YAML frontmatter in .github/skills/
- memory-query skill includes command-equivalent instructions (no TOML needed)
- Navigator agent is a separate .agent.md file with full intelligence (not embedded in skill)
- plugin.json enables /plugin install
- No TOML command files created (Copilot does not use TOML)
- Skills are separate copies (not symlinks) for portability
</verification>

<success_criteria>
- 5 skill directories in .github/skills/ with SKILL.md + references/
- 1 navigator agent .agent.md file with tier routing, intent classification, fallback chains
- 1 plugin.json manifest with correct metadata
- memory-query skill covers search, recent, and context functionality
- All files use correct Copilot CLI format (SKILL.md for skills, .agent.md for agent)
</success_criteria>

<output>
After completion, create `.planning/phases/22-copilot-cli-adapter/22-02-SUMMARY.md`
</output>
